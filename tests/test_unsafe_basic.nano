/* Test basic unsafe block functionality */

extern fn getenv(name: string) -> string

fn test_unsafe_block() -> int {
    /* This should require an unsafe block */
    unsafe {
        let home: string = (getenv "HOME")
        if (> (str_length home) 0) {
            return 1
        } else {
            return 0
        }
    }
}

/* Shadow test cannot run because interpreter doesn't have getenv FFI */
/* shadow test_unsafe_block {
    let result: int = (test_unsafe_block)
    assert (or (== result 0) (== result 1))
} */

fn main() -> int {
    (println "Testing unsafe blocks...")
    let result: int = (test_unsafe_block)
    (print "Unsafe block executed successfully, result: ")
    (println result)
    return 0
}

shadow main {
    assert (== (main) 0)
}

