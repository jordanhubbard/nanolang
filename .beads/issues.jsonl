{"id":"nl-fok","title":"Extra closing brace in typecheck.nano and transpiler.nano parse errors","description":"## Summary\n\nTwo parse errors introduced in commit 75bd6e74 due to extra closing braces in deeply nested else/if chains.\n\n## Errors\n\n1. src_nano/typecheck.nano line 2687: Extra } at end of array_elem_type_from_array_decl()\n2. src_nano/transpiler.nano line 1515: Extra } at end of array_elem_type_from_array_type()\n\nBoth functions use deeply nested 'else { if' chains and had one extra closing brace.\n\n## Fix Applied\n\nRemoved the extra closing brace from each function. Verified brace depth reaches 0 correctly.\n\n## Status: FIXED (pending commit)","status":"closed","priority":1,"issue_type":"bug","owner":"jordanhubbard@gmail.com","created_at":"2026-02-19T03:08:04Z","created_by":"Jordan Hubbard","updated_at":"2026-02-19T03:08:10Z","closed_at":"2026-02-19T03:08:10Z","close_reason":"Fixed: removed extra closing braces from array_elem_type_from_array_decl() in typecheck.nano and array_elem_type_from_array_type() in transpiler.nano","labels":["compiler","fixed","parser"]}
{"id":"nl-hmt","title":"Stage1 compiler infinite loop on 'from ... import' with multiple modules","description":"## Summary\n\nThe self-hosted stage1 compiler (nanoc_stage1) enters an apparent infinite loop / exponential memory blowup when compiling files that use 'from ... import' with multiple modules. The C reference compiler (nanoc_c) compiles the same files in seconds.\n\n## Reproduction\n\n    # Hangs indefinitely (100% CPU, memory grows to \u003e3.6GB):\n    timeout 120 bin/nanoc_stage1 examples/language/simple_repl.nano -o /tmp/test_repl\n\n    # Works fine in seconds:\n    timeout 120 bin/nanoc_c examples/language/simple_repl.nano -o /tmp/test_repl\n\n## Affected Files\n\n- examples/language/simple_repl.nano (256 lines)\n- examples/language/vars_repl.nano (similar structure)\n\nBoth share the same 'from ... import' pattern:\n\n    from \"modules/readline/readline.nano\" import rl_readline, rl_add_history, ...\n    from \"modules/nano_tools/nano_tools.nano\" import eval_internal\n    from \"modules/std/collections/stringbuilder.nano\" import StringBuilder, sb_new, ...\n\n## Impact\n\n- make examples fails: examples-stage1 target hangs on simple_repl.nano, exceeding 600s CMD_TIMEOUT\n- Blocks CI autobeads.py examples workflow\n- All other examples (54+ files) compile correctly with stage1\n\n## Diagnosis\n\n- Stage1 process reaches 100% CPU and 3.6GB+ RSS compiling a 256-line file\n- C reference compiler handles the same file in \u003c5 seconds\n- Common pattern: 'from ... import' with multiple module imports\n- Standard 'module' and 'import' directives work fine in stage1\n- Issue appears to be in module resolution or code generation for 'from ... import' syntax\n\n## Environment\n\n- Commit: 75bd6e74 (feat(compiler): achieve 54/54 stage1 examples passing)\n- Platform: Linux x86_64\n- The files were NOT changed in the recent commit; pre-existing stage1 limitation\n\n## Suggested Investigation\n\n1. Check src_nano/transpiler.nano and src_nano/compiler/module_loader.nano for 'from ... import' handling\n2. Profile/trace stage1 to identify which phase loops (likely transpile or module resolution)\n3. Compare code paths for 'from X import Y' vs 'module X' in stage1\n4. Consider adding per-file timeout to examples build as workaround","notes":"Root cause: Not actually an infinite loop. Stage1 compiler completes on simple_repl.nano (C compilation fails due to HashMap\u003cstring,string\u003e codegen limitation, but NanoLang compilation succeeds). The make examples timeout was caused by: (1) SDL launcher hanging in headless mode, blocking the pipeline, (2) stale bootstrap sentinels triggering unnecessary rebuilds. Both fixed in Makefile.gnu.","status":"closed","priority":0,"issue_type":"bug","owner":"jordanhubbard@gmail.com","created_at":"2026-02-19T03:07:50Z","created_by":"Jordan Hubbard","updated_at":"2026-02-20T06:43:26Z","closed_at":"2026-02-20T06:39:55Z","labels":["compiler","p0","performance","stage1"]}
{"id":"nl-jm5","title":"[autotest] Examples build failed: make examples","description":"Autogenerated by scripts/autobeads.py\n\nKind: examples\nName: make examples\nKey: examples:make examples\nFingerprint: e4d5efb1af23\nFirst seen: 2026-02-18T19:31:07\n\n---\nLog tail: /home/jkh/Src/nanolang/.test_output/make_examples.log\n\n [-Wint-conversion]\net_string (return type: ASTString)\n  Generating: parser_get_bool_count (return type: int)\n  Generating: parser_get_bool (return type: ASTBool)\n  Generating: parser_get_assert_count (return type: int)\n  Generating: parser_get_assert (return type: ASTAssert)\n  Generating: parser_get_field_access_count (return type: int)\n  Generating: parser_get_field_access (return type: ASTFieldAccess)\n  Generating: parser_get_array_literal_count (return type: int)\n  Generating: parser_get_array_literal (return type: ASTArrayLiteral)\n  Generating: parser_set_array_literal_element_type (return type: Parser)\n  Generating: parser_get_array_element_count (return type: int)\n  Generating: parser_get_array_element (return type: ASTStmtRef)\n  Generating: parser_get_struct_def_count (return type: int)\n  Generating: parser_get_struct_def (return type: ASTStruct)\n  Generating: parser_get_struct_literal_count (return type: int)\n  Generating: parser_get_struct_literal (return type: ASTStructLiteral)\n  Generating: parser_get_enum_count (return type: int)\n  Generating: parser_get_enum (return type: ASTEnum)\n  Generating: parser_get_union_count (return type: int)\n  Generating: parser_get_union (return type: ASTUnion)\n  Generating: parser_get_union_construct_count (return type: int)\n  Generating: parser_get_union_construct (return type: ASTUnionConstruct)\n  Generating: parser_get_match_count (return type: int)\n  Generating: parser_get_match (return type: ASTMatch)\n  Generating: parser_get_tuple_literal_count (return type: int)\n  Generating: parser_get_tuple_literal (return type: ASTTupleLiteral)\n  Generating: parser_get_tuple_index_count (return type: int)\n  Generating: parser_get_tuple_index (return type: ASTTupleIndex)\n  Generating: parser_get_import_count (return type: int)\n  Generating: parser_get_import (return type: ASTImport)\n  Generating: parse_phase_run (return type: ParsePhaseOutput)\n  Generating: eval (return type: int)\n  Generating: lex_phase_run (return type: LexPhaseOutput)\n  Generating: string_in_array (return type: bool)\n  Generating: collect_shadow_names (return type: array\u003cstring\u003e)\n  Generating: append_diags (return type: void)\n  Generating: lint_source (return type: List\u003cCompilerDiagnostic\u003e)\n  Generating: syntax_check_source (return type: List\u003cCompilerDiagnostic\u003e)\n  Generating: lint_file (return type: List\u003cCompilerDiagnostic\u003e)\n  Generating: syntax_check_file (return type: List\u003cCompilerDiagnostic\u003e)\n  Generating: lint_format (return type: string)\n  Generating: eval_internal (return type: int)\n  Generating: ansi_escape (return type: string)\n  Generating: html_entity_to_char (return type: string)\n  Generating: ansi_for_class (return type: string)\n  Generating: str_matches_at (return type: bool)\n  Generating: highlight_html_to_ansi (return type: string)\n  Generating: pretty_print_html (return type: string)\n  Generating: pretty_print_ansi (return type: string)\n  Generating: print_banner (return type: void)\n  Generating: print_help (return type: void)\n  Generating: wrap_expression (return type: string)\n  Generating: str_trim (return type: string)\n  Generating: is_command (return type: bool)\n  Generating: is_empty (return type: bool)\n  Generating: eval_expression (return type: int)\n  Generating: get_history_file (return type: string)\n  Generating: clear_screen (return type: void)\n  Generating: run_repl (return type: int)\n  Generating: main (return type: int)\nâœ“ Code generation complete!\nError: C compilation failed\nmake[6]: *** [Makefile:324: ../bin/simple_repl] Error 1\nmake[6]: Leaving directory '/home/jkh/Src/nanolang/examples'\nmake[5]: *** [Makefile.gnu:656: examples-stage1] Error 2\nmake[5]: Leaving directory '/home/jkh/Src/nanolang'\nmake[4]: *** [Makefile:56: examples-core] Error 2\nmake[4]: Leaving directory '/home/jkh/Src/nanolang'\nmake[3]: *** [Makefile.gnu:639: examples] Error 2\nmake[3]: Leaving directory '/home/jkh/Src/nanolang'\nmake[2]: *** [Makefile:47: examples] Error 2\nmake[2]: Leaving directory '/home/jkh/Src/nanolang'\n\n","notes":"[autotest] Seen again at 2026-02-19T09:04:42\nKind: examples\nName: make examples\nFingerprint: f79df7d8fd4f\n\n---\nLog tail: /home/jkh/Src/nanolang/.test_output/make_examples.log\n\nst_ASTIdentifier.o obj/runtime/list_ASTBinaryOp.o obj/runtime/list_ASTCall.o obj/runtime/list_ASTModuleQualifiedCall.o obj/runtime/list_ASTArrayLiteral.o obj/runtime/list_ASTLet.o obj/runtime/list_ASTSet.o obj/runtime/list_ASTStmtRef.o obj/runtime/list_ASTIf.o obj/runtime/list_ASTWhile.o obj/runtime/list_ASTFor.o obj/runtime/list_ASTReturn.o obj/runtime/list_ASTBlock.o obj/runtime/list_ASTUnsafeBlock.o obj/runtime/list_ASTPrint.o obj/runtime/list_ASTAssert.o obj/runtime/list_ASTFunction.o obj/runtime/list_ASTShadow.o obj/runtime/list_ASTStruct.o obj/runtime/list_ASTStructLiteral.o obj/runtime/list_ASTFieldAccess.o obj/runtime/list_ASTEnum.o obj/runtime/list_ASTUnion.o obj/runtime/list_ASTUnionConstruct.o obj/runtime/list_ASTMatch.o obj/runtime/list_ASTImport.o obj/runtime/list_ASTOpaqueType.o obj/runtime/list_ASTTupleLiteral.o obj/runtime/list_ASTTupleIndex.o obj/runtime/token_helpers.o obj/runtime/gc.o obj/runtime/dyn_array.o obj/runtime/gc_struct.o obj/runtime/nl_string.o obj/runtime/ffi_loader.o obj/runtime/cli.o obj/runtime/regex.o \\\n\tobj/nanovm/vmd_protocol.o obj/nanovm/vmd_client.o \\\n\tobj/nanovm/main.o -lm -rdynamic\ncc -Wall -Wextra -Werror -std=c99 -g -Isrc -D_GNU_SOURCE -c src/nanovm/cop_main.c -o obj/nanovm/cop_main.o\ncc -Wall -Wextra -Werror -std=c99 -g -Isrc -D_GNU_SOURCE -o bin/nano_cop obj/nanovm/value.o obj/nanovm/heap.o obj/nanovm/vm.o obj/nanovm/vm_ffi.o obj/nanovm/vm_builtins.o obj/nanovm/cop_protocol.o obj/nanoisa/isa.o obj/nanoisa/nvm_format.o obj/nanoisa/assembler.o obj/nanoisa/disassembler.o obj/nanoisa/verifier.o obj/lexer.o obj/parser.o obj/typechecker.o obj/transpiler.o obj/stdlib_runtime.o obj/env.o obj/builtins_registry.o obj/module.o obj/module_metadata.o obj/cJSON.o obj/toon_output.o obj/module_builder.o obj/resource_tracking.o obj/eval.o obj/eval/eval_hashmap.o obj/eval/eval_math.o obj/eval/eval_string.o obj/eval/eval_io.o obj/interpreter_ffi.o obj/json_diagnostics.o obj/reflection.o obj/nanocore_subset.o obj/nanocore_export.o obj/runtime/list_int.o obj/runtime/list_string.o obj/runtime/list_LexerToken.o obj/runtime/list_token.o obj/runtime/list_CompilerDiagnostic.o obj/runtime/list_CompilerSourceLocation.o obj/runtime/list_ASTNumber.o obj/runtime/list_ASTFloat.o obj/runtime/list_ASTString.o obj/runtime/list_ASTBool.o obj/runtime/list_ASTIdentifier.o obj/runtime/list_ASTBinaryOp.o obj/runtime/list_ASTCall.o obj/runtime/list_ASTModuleQualifiedCall.o obj/runtime/list_ASTArrayLiteral.o obj/runtime/list_ASTLet.o obj/runtime/list_ASTSet.o obj/runtime/list_ASTStmtRef.o obj/runtime/list_ASTIf.o obj/runtime/list_ASTWhile.o obj/runtime/list_ASTFor.o obj/runtime/list_ASTReturn.o obj/runtime/list_ASTBlock.o obj/runtime/list_ASTUnsafeBlock.o obj/runtime/list_ASTPrint.o obj/runtime/list_ASTAssert.o obj/runtime/list_ASTFunction.o obj/runtime/list_ASTShadow.o obj/runtime/list_ASTStruct.o obj/runtime/list_ASTStructLiteral.o obj/runtime/list_ASTFieldAccess.o obj/runtime/list_ASTEnum.o obj/runtime/list_ASTUnion.o obj/runtime/list_ASTUnionConstruct.o obj/runtime/list_ASTMatch.o obj/runtime/list_ASTImport.o obj/runtime/list_ASTOpaqueType.o obj/runtime/list_ASTTupleLiteral.o obj/runtime/list_ASTTupleIndex.o obj/runtime/token_helpers.o obj/runtime/gc.o obj/runtime/dyn_array.o obj/runtime/gc_struct.o obj/runtime/nl_string.o obj/runtime/ffi_loader.o obj/runtime/cli.o obj/runtime/regex.o \\\n\tobj/nanovm/cop_main.o -lm -rdynamic\n/bin/ld: obj/module.o: in function `compile_module_to_object':\n/home/jkh/Src/nanolang/src/module.c:1224:(.text+0x3a2c): undefined reference to `get_project_root'\ncollect2: error: ld returned 1 exit status\nmake[5]: *** [Makefile.gnu:334: nano_cop] Error 1\nmake[5]: Leaving directory '/home/jkh/Src/nanolang'\nmake[4]: *** [Makefile:56: examples-core] Error 2\nmake[4]: Leaving directory '/home/jkh/Src/nanolang'\nmake[3]: *** [Makefile.gnu:641: examples] Error 2\nmake[3]: Leaving directory '/home/jkh/Src/nanolang'\nmake[2]: *** [Makefile:47: examples] Error 2\nmake[2]: Leaving directory '/home/jkh/Src/nanolang'\n\n","status":"closed","priority":4,"issue_type":"bug","owner":"jordanhubbard@gmail.com","created_at":"2026-02-19T03:31:07Z","created_by":"Jordan Hubbard","updated_at":"2026-02-20T06:39:21Z","closed_at":"2026-02-20T06:39:21Z","close_reason":"Closed","labels":["autotest","examples"]}
