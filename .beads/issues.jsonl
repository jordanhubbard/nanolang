{"id":"nl-fok","title":"Extra closing brace in typecheck.nano and transpiler.nano parse errors","description":"## Summary\n\nTwo parse errors introduced in commit 75bd6e74 due to extra closing braces in deeply nested else/if chains.\n\n## Errors\n\n1. src_nano/typecheck.nano line 2687: Extra } at end of array_elem_type_from_array_decl()\n2. src_nano/transpiler.nano line 1515: Extra } at end of array_elem_type_from_array_type()\n\nBoth functions use deeply nested 'else { if' chains and had one extra closing brace.\n\n## Fix Applied\n\nRemoved the extra closing brace from each function. Verified brace depth reaches 0 correctly.\n\n## Status: FIXED (pending commit)","status":"closed","priority":1,"issue_type":"bug","owner":"jordanhubbard@gmail.com","created_at":"2026-02-19T03:08:04Z","created_by":"Jordan Hubbard","updated_at":"2026-02-19T03:08:10Z","closed_at":"2026-02-19T03:08:10Z","close_reason":"Fixed: removed extra closing braces from array_elem_type_from_array_decl() in typecheck.nano and array_elem_type_from_array_type() in transpiler.nano","labels":["compiler","fixed","parser"]}
{"id":"nl-hmt","title":"Stage1 compiler infinite loop on 'from ... import' with multiple modules","description":"## Summary\n\nThe self-hosted stage1 compiler (nanoc_stage1) enters an apparent infinite loop / exponential memory blowup when compiling files that use 'from ... import' with multiple modules. The C reference compiler (nanoc_c) compiles the same files in seconds.\n\n## Reproduction\n\n    # Hangs indefinitely (100% CPU, memory grows to \u003e3.6GB):\n    timeout 120 bin/nanoc_stage1 examples/language/simple_repl.nano -o /tmp/test_repl\n\n    # Works fine in seconds:\n    timeout 120 bin/nanoc_c examples/language/simple_repl.nano -o /tmp/test_repl\n\n## Affected Files\n\n- examples/language/simple_repl.nano (256 lines)\n- examples/language/vars_repl.nano (similar structure)\n\nBoth share the same 'from ... import' pattern:\n\n    from \"modules/readline/readline.nano\" import rl_readline, rl_add_history, ...\n    from \"modules/nano_tools/nano_tools.nano\" import eval_internal\n    from \"modules/std/collections/stringbuilder.nano\" import StringBuilder, sb_new, ...\n\n## Impact\n\n- make examples fails: examples-stage1 target hangs on simple_repl.nano, exceeding 600s CMD_TIMEOUT\n- Blocks CI autobeads.py examples workflow\n- All other examples (54+ files) compile correctly with stage1\n\n## Diagnosis\n\n- Stage1 process reaches 100% CPU and 3.6GB+ RSS compiling a 256-line file\n- C reference compiler handles the same file in \u003c5 seconds\n- Common pattern: 'from ... import' with multiple module imports\n- Standard 'module' and 'import' directives work fine in stage1\n- Issue appears to be in module resolution or code generation for 'from ... import' syntax\n\n## Environment\n\n- Commit: 75bd6e74 (feat(compiler): achieve 54/54 stage1 examples passing)\n- Platform: Linux x86_64\n- The files were NOT changed in the recent commit; pre-existing stage1 limitation\n\n## Suggested Investigation\n\n1. Check src_nano/transpiler.nano and src_nano/compiler/module_loader.nano for 'from ... import' handling\n2. Profile/trace stage1 to identify which phase loops (likely transpile or module resolution)\n3. Compare code paths for 'from X import Y' vs 'module X' in stage1\n4. Consider adding per-file timeout to examples build as workaround","status":"open","priority":0,"issue_type":"bug","owner":"jordanhubbard@gmail.com","created_at":"2026-02-19T03:07:50Z","created_by":"Jordan Hubbard","updated_at":"2026-02-19T03:07:50Z","labels":["compiler","p0","performance","stage1"]}
